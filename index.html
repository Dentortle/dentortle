<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dentortle Pathology Quiz</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #clues { margin-bottom: 10px; }
    #autocomplete { border: 1px solid #ccc; max-height: 100px; overflow-y: auto; }
    .autocomplete-item { padding: 5px; cursor: pointer; }
    .autocomplete-item:hover { background-color: #f0f0f0; }
</style>
</head>
<body>

<h1>Dentortle Pathology Quiz</h1>
<div id="clues"></div>
<input type="text" id="answerInput" placeholder="Type your answer here">
<div id="autocomplete"></div>
<button id="submitBtn">Submit</button>
<div id="result"></div>

<script>
// ----------------- CASE DATA -----------------
const cases = [
    {
        query: "Dentin Dysplasia Type II (Coronal)",
        clues: [
            "A young child's primary teeth exhibit a blue/brown translucency.",
            "This condition is inherited as an autosomal dominant trait.",
            "Radiographs show bulbous crowns and cervical constriction.",
            "Permanent teeth appear clinically normal with enlarged pulp chambers ('thistle tube-shaped')."
        ],
        answer: "Dentin Dysplasia Type II (Coronal)",
        aliases: ["Recurrent herpes infection","Herpes simplex associated Recurrent herpes simplex infection"]
    },
    {
        query: "Primary Herpetic Gingivostomatitis (PHG)",
        clues: [
            "A 3-year-old child presents with cervical lymphadenopathy, fever, and anorexia.",
            "Numerous vesicles that ulcerate are found throughout the mouth.",
            "Infection is typically self-limiting (5–14 days).",
            "Causative agent: HSV-1."
        ],
        answer: "Primary Herpetic Gingivostomatitis",
        aliases: []
    },
    {
        query: "Recurrent Herpes Simplex Infection (Herpes Labialis)",
        clues: [
            "Patient reports prodromal tingling before lesion onset.",
            "Lesions most commonly on the vermillion border of the lower lip.",
            "Intraoral lesions occur exclusively on keratinized mucosa.",
            "Healing occurs within 7–10 days."
        ],
        answer: "Recurrent Herpes Simplex Infection",
        aliases: ["Recurrent herpes infection","Herpes simplex associated Recurrent herpes simplex infection"]
    }
    // ... you would continue adding all 50 cases in the same format
];

// ----------------- ANSWER CHOICES -----------------
const answerChoices = [
    "Attrition","Erosion","Abrasion","Hyperdontia","Hypodontia","Microdontia",
    "Gemination","Fusion","Talon Cusp","Concrescence","Dilaceration","Taurodontism",
    "Dens Invaginatus","Hypercementosis","Ankylosis (Dental)","Amelogenesis Imperfecta",
    "Dentin Dysplasia Type I (Radicular)","Turner Hypoplasia","Syphilitic Hypoplasia",
    "Erythema Migrans","Ankyloglossia","White Sponge Nevus","Double Lip","Fordyce Granules",
    "Leukoedema","Linea Alba","Macroglossia","Lingual Thyroid","Fissured Tongue","Hairy Tongue",
    "Lingual Varicosities","Exostoses","Torus Mandibularis","Torus Palatinus","Nasolabial Cyst",
    "Nasopalatine Duct Cyst","Dermoid Cyst","Oral Lymphoepithelial Cyst","Amalgam Tattoo",
    "Epulis Fissuratum","Inflammatory Papillary Hyperplasia","Pyogenic Granuloma",
    "Peripheral Giant Cell Granuloma","Peripheral Ossifying Fibroma","Congenital Epulis",
    "Periapical Cyst","Residual Cyst","Internal Resorption","External Resorption","Condensing Osteitis"
];

// ----------------- APP STATE -----------------
let currentCaseIndex = 0;
let clueIndex = 0;

// ----------------- DOM ELEMENTS -----------------
const cluesDiv = document.getElementById("clues");
const answerInput = document.getElementById("answerInput");
const autocompleteDiv = document.getElementById("autocomplete");
const resultDiv = document.getElementById("result");
const submitBtn = document.getElementById("submitBtn");

// ----------------- FUNCTIONS -----------------
function updateClues() {
    cluesDiv.innerHTML = `<strong>Case ${currentCaseIndex + 1}:</strong> ${cases[currentCaseIndex].clues[clueIndex]}`;
}

function showAutocomplete() {
    const input = answerInput.value.toLowerCase();
    autocompleteDiv.innerHTML = "";
    if(!input) return;
    const filtered = answerChoices.filter(a => a.toLowerCase().includes(input));
    filtered.forEach(item => {
        const div = document.createElement("div");
        div.textContent = item;
        div.className = "autocomplete-item";
        div.onclick = () => { answerInput.value = item; autocompleteDiv.innerHTML = ""; };
        autocompleteDiv.appendChild(div);
    });
}

function submitAnswer() {
    const userAnswer = answerInput.value.trim().toLowerCase();
    const currentCase = cases[currentCaseIndex];
    let correctAnswers = [currentCase.answer.toLowerCase()];
    if(currentCase.aliases) correctAnswers.push(...currentCase.aliases.map(a => a.toLowerCase()));

    // Check if user answer matches any correct answer (partial match allowed)
    const isCorrect = correctAnswers.some(a => a.includes(userAnswer) || userAnswer.includes(a));

    if(isCorrect){
        resultDiv.innerHTML = `✅ Correct!`;
        currentCaseIndex++;
        clueIndex = 0;
    } else {
        clueIndex++;
        if(clueIndex < currentCase.clues.length){
            updateClues();
            resultDiv.innerHTML = `❌ Incorrect. Here's the next clue.`;
        } else {
            resultDiv.innerHTML = `❌ Incorrect. The correct answer was: ${currentCase.answer}`;
            currentCaseIndex++;
            clueIndex = 0;
        }
    }

    answerInput.value = "";
    autocompleteDiv.innerHTML = "";

    if(currentCaseIndex < cases.length){
        updateClues();
    } else {
        cluesDiv.innerHTML = "🎉 You've completed all cases!";
        submitBtn.disabled = true;
    }
}

// ----------------- EVENT LISTENERS -----------------
answerInput.addEventListener("input", showAutocomplete);
submitBtn.addEventListener("click", submitAnswer);
answerInput.addEventListener("keypress", (e) => { if(e.key === "Enter") submitAnswer(); });

// ----------------- INITIAL CLUE -----------------
updateClues();
</script>

</body>
</html>
