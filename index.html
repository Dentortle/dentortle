<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Dental Case Challenge</title>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; max-width: 800px; }
    .clue { margin: 15px 0; }
    input[type="text"] { padding: 5px; width: 300px; }
    button { padding: 5px 10px; margin-left: 5px; }
    #chart { max-width: 600px; margin-top: 30px; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Daily Dental Case Challenge</h1>
<p id="date"></p>
<div id="game">
    <div class="clue" id="clueText"></div>
    <input type="text" id="guess" placeholder="Your answer here">
    <button onclick="submitGuess()">Submit</button>
    <p id="feedback"></p>
</div>
<canvas id="chart"></canvas>

<script>
/* ======= Cases Data ======= */
// Replace with all 100 cases
const cases = [
    {
        clues: [
            "A young child's primary teeth exhibit a blue/brown translucency.",
            "Autosomal dominant trait.",
            "Radiographs show bulbous crowns and cervical constriction.",
            "Root length is normal in both primary and permanent dentition.",
            "Permanent teeth appear clinically normal.",
            "Enlarged pulp chambers with apical extensions ('thistle tube-shaped')."
        ],
        answer: "Dentin Dysplasia Type II"
    },
    {
        clues: [
            "3-year-old child with cervical lymphadenopathy, fever, chills.",
            "Numerous vesicles that quickly break down into ulcers.",
            "Lesions affect both keratinized and non-keratinized mucosa.",
            "Self-limiting, resolving in 5â€“14 days.",
            "Caused by HSV-1 spread through saliva.",
            "Histology shows acantholysis, nuclear enlargement, multinucleation."
        ],
        answer: "Primary Herpetic Gingivostomatitis"
    }
    // Add all remaining cases here in the same format
];

/* ======= Daily Case Selection ======= */
const today = new Date();
document.getElementById("date").innerText = `Today's Date: ${today.toDateString()}`;

// Simple daily case rotation based on day count
const startDate = new Date("2025-10-17"); // adjust start date
const dayIndex = Math.floor((today - startDate) / (1000*60*60*24)) % cases.length;
const todaysCase = cases[dayIndex];

let clueIndex = 0;
let guesses = [];

/* ======= Game Logic ======= */
function submitGuess() {
    const guessInput = document.getElementById("guess");
    const feedback = document.getElementById("feedback");
    const userGuess = guessInput.value.trim();
    if (!userGuess) return;
    guesses.push(userGuess);

    if (userGuess.toLowerCase() === todaysCase.answer.toLowerCase()) {
        feedback.innerText = `Correct! You got it in ${guesses.length}/6 clues.`;
        saveScore(guesses.length);
        showChart();
        disableGame();
    } else {
        clueIndex++;
        if (clueIndex >= todaysCase.clues.length) {
            feedback.innerText = `Incorrect. The answer was: ${todaysCase.answer}.`;
            saveScore(6);
            showChart();
            disableGame();
        } else {
            feedback.innerText = `Incorrect. Here's the next clue.`;
            document.getElementById("clueText").innerText = todaysCase.clues[clueIndex];
            guessInput.value = "";
            guessInput.focus();
        }
    }
}

function disableGame() {
    document.getElementById("guess").disabled = true;
}

/* ======= Initialize First Clue ======= */
document.getElementById("clueText").innerText = todaysCase.clues[clueIndex];

/* ======= LocalStorage Score Tracking ======= */
function saveScore(score) {
    let scores = JSON.parse(localStorage.getItem("dentalScores")) || [];
    scores.push({ date: today.toDateString(), score: score });
    localStorage.setItem("dentalScores", JSON.stringify(scores));
}

/* ======= Chart Display ======= */
function showChart() {
    let scores = JSON.parse(localStorage.getItem("dentalScores")) || [];
    const ctx = document.getElementById('chart').getContext('2d');
    const chartData = {
        labels: scores.map(s => s.date),
        datasets: [{
            label: 'Clues Taken',
            data: scores.map(s => s.score),
            borderColor: 'blue',
            fill: false,
            tension: 0.2
        }]
    };
    new Chart(ctx, { type: 'line', data: chartData });
}
</script>

</body>
</html>
