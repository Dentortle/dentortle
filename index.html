<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dental Pathology Daily Quiz</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        color: #333;
    }
    h1 { margin-top: 20px; text-align:center; }
    #clues { margin: 20px 0; max-width: 800px; text-align: left; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    #guessForm { display: flex; gap: 10px; margin-bottom: 20px; max-width: 800px; width: 100%; }
    #guess { padding: 10px; font-size: 16px; flex: 1; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background-color: #007bff; color: #fff; }
    button:hover { background-color: #0056b3; }
    #message { margin: 10px 0; font-weight: bold; max-width: 800px; text-align: center; }
    #scoreBoard { margin-top: 30px; max-width: 800px; text-align: center; }
    canvas { max-width: 100%; }
    .hidden { display: none; }
</style>
</head>
<body>
<h1>Dental Pathology Daily Quiz</h1>

<div id="clues">Loading today's case...</div>

<form id="guessForm">
    <input type="text" id="guess" placeholder="Type your answer here..." list="answersList" autocomplete="off">
    <datalist id="answersList"></datalist>
    <button type="submit">Submit</button>
</form>

<button id="nextCase" class="hidden">Next Case</button>

<div id="message"></div>

<div id="scoreBoard">
    <h2>Past Performance</h2>
    <canvas id="scoreChart" width="400" height="200"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Answer choices ---
const answerChoices = [
"Attrition","Erosion","Abrasion","Hyperdontia","Hypodontia","Microdontia","Gemination","Fusion",
"Talon Cusp","Concrescence","Dilaceration","Taurodontism","Dens Invaginatus","Hypercementosis",
"Ankylosis (Dental)","Amelogenesis Imperfecta","Dentin Dysplasia Type I (Radicular)",
"Turner Hypoplasia","Syphilitic Hypoplasia","Erythema Migrans","Ankyloglossia","White Sponge Nevus",
"Double Lip","Fordyce Granules","Leukoedema","Linea Alba","Macroglossia","Lingual Thyroid","Fissured Tongue",
"Hairy Tongue","Lingual Varicosities","Exostoses","Torus Mandibularis","Torus Palatinus","Nasolabial Cyst",
"Nasopalatine Duct Cyst","Dermoid Cyst","Oral Lymphoepithelial Cyst","Amalgam Tattoo","Epulis Fissuratum",
"Inflammatory Papillary Hyperplasia","Pyogenic Granuloma","Peripheral Giant Cell Granuloma",
"Peripheral Ossifying Fibroma","Congenital Epulis","Periapical Cyst","Residual Cyst","Internal Resorption",
"External Resorption","Condensing Osteitis","Dentin Dysplasia Type II (Coronal)","Primary Herpetic Gingivostomatitis (PHG)",
"Recurrent Herpes Simplex Infection (Herpes Labialis)","Varicella","Herpes Zoster","Infectious Mononucleosis",
"Oral Hairy Leukoplakia (OHL)","Kaposi Sarcoma","Papilloma (Squamous Cell Papilloma)","Verruca Vulgaris",
"Condyloma Acuminatum","Multifocal Epithelial Hyperplasia (Heck Disease)","Herpangina","Hand-Foot-and-Mouth Disease (HFMD)",
"Pseudomembranous Candidiasis","Chronic Hyperplastic Candidiasis","Acute Atrophic Candidiasis","Central Papillary Atrophy (Median Rhomboid Glossitis)",
"Angular Cheilitis","Denture Stomatitis (Chronic Atrophic Candidiasis)","Disseminated Histoplasmosis","Mucormycosis",
"Paget Disease (Osteitis Deformans)","Cherubism","Osteoma","Osteoblastoma","Osteosarcoma","Metastatic Tumors of the Jaw",
"Aneurysmal Bone Cyst (ABC)","Central Giant Cell Granuloma (CGCG)","Intrabony Vascular Malformation",
"Fibrous Dysplasia","Florid Cemento-Osseous Dysplasia (FCOD)","Ossifying Fibroma","Acromegaly",
"Hypothyroidism (Myxedema/Cretinism)","Thrombocytopenia","Leukemia","Hodgkin Lymphoma","Non-Hodgkin Lymphoma",
"Burkitt Lymphoma","Plasmacytoma (Extramedullary Myeloma)","Langerhans Cell Histiocytosis"
];

// --- Cases --- (Use same cases array from your 20 provided)
const cases = [/* Insert the 20 cases objects here exactly as before */];

// --- Elements ---
const cluesDiv = document.getElementById("clues");
const form = document.getElementById("guessForm");
const guessInput = document.getElementById("guess");
const messageDiv = document.getElementById("message");
const nextButton = document.getElementById("nextCase");
const dataList = document.getElementById("answersList");

// --- Populate datalist ---
answerChoices.forEach(a=>{ let option=document.createElement("option"); option.value=a; dataList.appendChild(option); });

// --- State ---
let caseIndex = Math.floor(Math.random()*cases.length);
let todaysCase = cases[caseIndex];
let clueIndex = 0;
let usedClues = 0;
const maxClues = 6;

// --- LocalStorage score tracking ---
let scores = JSON.parse(localStorage.getItem("scores") || "[]");

// --- Display first clue ---
function showClues(){
    cluesDiv.innerHTML = todaysCase.clues.slice(0, clueIndex+1).join("<br><br>");
}
showClues();

// --- Chart setup ---
const ctx = document.getElementById("scoreChart").getContext("2d");
let myChart = new Chart(ctx,{
    type:'bar',
    data:{labels:[], datasets:[{label:'Clues used', data:[], backgroundColor:'rgba(0,123,255,0.7)'}]},
    options:{
        scales:{y:{beginAtZero:true, min:1, max:6, ticks:{stepSize:1}}},
        responsive:true
    }
});

// --- Update chart ---
function updateChart(){
    myChart.data.labels = scores.map(s=>s.date);
    myChart.data.datasets[0].data = scores.map(s=>s.cluesUsed);
    myChart.update();
}
updateChart();

// --- Handle guesses ---
form.addEventListener("submit", e=>{
    e.preventDefault();
    const guess = guessInput.value.trim();
    if(!guess) return;

    if(guess.toLowerCase() === todaysCase.answer.toLowerCase()){
        messageDiv.innerHTML = `Correct! Answer: <b>${todaysCase.answer}</b>. Clues used: ${usedClues+1}`;
        scores.push({date:new Date().toLocaleDateString(), cluesUsed:usedClues+1});
        localStorage.setItem("scores", JSON.stringify(scores));
        updateChart();
        form.querySelector("button").disabled = true;
        guessInput.disabled = true;
        nextButton.classList.remove("hidden");
    } else {
        usedClues++;
        if(clueIndex < todaysCase.clues.length-1) clueIndex++;
        showClues();
        if(usedClues >= maxClues){
            messageDiv.innerHTML = `Out of clues! Answer: <b>${todaysCase.answer}</b>`;
            scores.push({date:new Date().toLocaleDateString(), cluesUsed:maxClues});
            localStorage.setItem("scores", JSON.stringify(scores));
            updateChart();
            form.querySelector("button").disabled = true;
            guessInput.disabled = true;
            nextButton.classList.remove("hidden");
        } else {
            messageDiv.innerHTML = `Incorrect. Here's another clue (${clueIndex+1}/${maxClues}).`;
        }
    }
    guessInput.value="";
});

// --- Next Case ---
nextButton.addEventListener("click", ()=>{
    // Reset state
    caseIndex = (caseIndex+1) % cases.length;
    todaysCase = cases[caseIndex];
    clueIndex = 0;
    usedClues = 0;
    showClues();
    messageDiv.innerHTML = "";
    form.querySelector("button").disabled = false;
    guessInput.disabled = false;
    nextButton.classList.add("hidden");
});

</script>
</body>
</html>
